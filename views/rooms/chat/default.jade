extends layout

block content3
	#mainWrapper(ng-controller='chatDefaultCtrl' ng-cloak)
		.row
			.col-md-6.col-md-offset-2.col-xs-8
				#chatWrapper
					.panel.panel-default
						.panel-heading
							h3
								.row
									.col-xs-8
										|{{room.name}}
									.col-xs-4
										.dropdown.pull-right
											.button.btn.btn-default.dropdown-toggle(id='optionsMenu', data-toggle='dropdown', aria-haspopup='true', aria-expanded='true')
												|Options
												.span.caret
											ul.dropdown-menu(aria-labelledby='optionsMenu')
												li: a(href='', ng-click='clearChat()', ng-show='user.rank > 2') Clear chat
												li.divider(role='separator', ng-show='user.rank > 2')
												li: a(href='/rooms') Leave room
												li: a(href='/logout') Logout
						.panel-body
							#chatWindow(scroll-glue-bottom='scrollGlue')
								.row
									.col-md-12
										div(ng-repeat='message in messages track by $index')
											.msg(class='msg-{{message.username}}', ng-class="{'alert alert-danger': message.type==\"error\", 'alert alert-info': message.type==\"info\"}")
												.time {{message.time | date : '[HH:mm:ss] '}}
												.username {{message.username}}: 
												.text {{message.text}}
							form#messageForm(ng-submit='submit(msg)', novalidate, name='messageForm')
								.form-group
									.input-group
										input.form-control#message(size=35, placeholder='Write message...', ng-model='msg', required, ng-change='scrollGlue=false')
										.input-group-btn
											button.btn.btn-info(type='submit') Send
			.col-md-2.col-xs-4
				#userWrapper
					.panel.panel-default
						.panel-heading
							.text-center Online
						.panel-body
							#users
								ul.list-unstyled
									li(ng-repeat='username in usernames') {{username}}